{"version":3,"sources":["index.js"],"names":["blocks","document","querySelectorAll","blocksContainer","querySelector","viewContainer","coef","lastZindex","window","onload","init","i","length","style","backgroundColor","innerHTML","id","onmousedown","e","moving","block","position","zIndex","eventsNone","onmousemove","moveTo","onmouseup","event","target","inject","building","left","pageX","offsetWidth","top","pageY","offsetHeight","checkPosition","append","tmp","pointerEvents","findClosest","closest","fromWhere","console","log","parentNode","neighbors","x","getBoundingClientRect","y","neighborY","neighborX","neighborWidth","neighborHeight","closestY","closestX","replaceBlock","from","classList","add","prepend","setTimeout","remove"],"mappings":"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","file":"blocks.e31bb0bc.js","sourceRoot":"..","sourcesContent":["var blocks = document.querySelectorAll('.blocks-item');\r\nvar blocksContainer = document.querySelector('.blocks');\r\nvar viewContainer = document.querySelector('.view');\r\nvar coef = 25;\r\nvar lastZindex = 1;\r\n\r\nwindow.onload = init;\r\n\r\n//обработчик событий кнопки\r\n// document.querySelector(\".button.button--add\").onclick = function () {\r\n//     console.log()\r\n//     var div = document.createElement(\"div\");\r\n//     div.classList.add(\"blocks-item\");\r\n//     div.innerHTML = this.parentNode.querySelector(\"input\").value;\r\n//     blocksContainer.append(div);\r\n//     init();\r\n// }\r\n\r\n// инициализация\r\nfunction init() {\r\n    blocks = document.querySelectorAll('.blocks-item');\r\n    for (var i = 0; blocks.length > i; i++) {\r\n        blocks[i].style.backgroundColor = blocks[i].innerHTML;\r\n        blocks[i].id = \"block_\" + i;\r\n        blocks[i].onmousedown = function (e) {\r\n            moving(this)\r\n        }\r\n    }\r\n}\r\n\r\nfunction moving(block) {\r\n    block.style.position = \"fixed\";\r\n    block.style.zIndex = \"1\";\r\n    eventsNone(\"none\");\r\n    // событие начала\r\n    document.onmousemove = function (e) {\r\n        moveTo(block);\r\n    }\r\n    // событие окончания\r\n    document.onmouseup = function () {\r\n        if (event.target == blocksContainer || event.target == viewContainer) {\r\n            eventsNone(\"\");\r\n            inject(block);\r\n            building(block);\r\n            document.onmousemove = null;\r\n            block.onmouseup = null;\r\n        }\r\n    }\r\n}\r\n// перемещение за курсором\r\nfunction moveTo(block) {\r\n    block.style.left = event.pageX - block.offsetWidth / 2 + 'px';\r\n    block.style.top = event.pageY - block.offsetHeight / 2 + 'px';\r\n}\r\n// перемещаем в нужный блок\r\nfunction inject(block) {\r\n    checkPosition().append(block)\r\n    if (checkPosition() == blocksContainer) {\r\n        block.style.position = \"\";\r\n        block.style.top = \"\";\r\n        block.style.left = \"\";\r\n    }\r\n}\r\n// проверяем в какой блок попадает\r\nfunction checkPosition() {\r\n    if (event.target == blocksContainer) {\r\n        return blocksContainer;\r\n    }\r\n    if (event.target == viewContainer) {\r\n        return viewContainer;\r\n    }\r\n}\r\n// функция обнуления всех ивентов\r\nfunction eventsNone(tmp) {\r\n    for (var i = 0; blocks.length > i; i++) {\r\n        blocks[i].style.pointerEvents = tmp;\r\n    }\r\n}\r\n\r\nfunction building(block) {\r\n    if (findClosest(block)) {\r\n        var closest = findClosest(block);\r\n        fromWhere(block, closest);\r\n\r\n\r\n        console.log(block,closest)\r\n    }\r\n}\r\n\r\nfunction findClosest(block) {\r\n    if (block.parentNode == viewContainer) {\r\n        var neighbors = block.parentNode.querySelectorAll(\".blocks-item\"),\r\n            x = block.getBoundingClientRect().left,\r\n            y = block.getBoundingClientRect().top;\r\n\r\n        for (var i = 0; i < neighbors.length; i++) {\r\n            if (neighbors[i] != block) {\r\n                var neighborY = neighbors[i].getBoundingClientRect().top,\r\n                    neighborX = neighbors[i].getBoundingClientRect().left,\r\n                    neighborWidth = neighborX + neighbors[i].offsetWidth,\r\n                    neighborHeight = neighborY + neighbors[i].offsetHeight;\r\n\r\n                if (y + block.offsetHeight > neighborY - coef && neighborHeight + coef > y && x + block.offsetWidth > neighborX - coef && neighborWidth + coef > x) {\r\n                    return (neighbors[i])\r\n                }\r\n            }\r\n        }\r\n\r\n    }\r\n}\r\n\r\nfunction fromWhere(block, closest) {\r\n    var closestY = closest.getBoundingClientRect().top,\r\n        closestX = closest.getBoundingClientRect().left,\r\n        y = block.getBoundingClientRect().top,\r\n        x = block.getBoundingClientRect().left;\r\n\r\n    if (y - coef / 2 >= closestY && x + block.offsetWidth / 2 > closestX && x - block.offsetWidth / 2 < closestX) {\r\n        replaceBlock(block, closest, \"down\")\r\n    }\r\n    if (y < closestY + coef / 2 && x + block.offsetWidth / 2 > closestX && x - block.offsetWidth / 2 < closestX) {\r\n        replaceBlock(block, closest, \"up\")\r\n    }\r\n    if (x - coef / 2 >= closestX && y + block.offsetHeight / 2 > closestY && y - block.offsetHeight / 2 < closestY) {\r\n        replaceBlock(block, closest, \"right\")\r\n    }\r\n    if (x < closestX + coef / 2 && y + block.offsetHeight / 2 > closestY && y - block.offsetHeight / 2 < closestY) {\r\n        replaceBlock(block, closest, \"left\")\r\n    }\r\n}\r\n\r\nfunction replaceBlock(block, closest, from) {\r\n    if (from == \"up\") {\r\n        block.classList.add('blocks-item--animate');\r\n        block.style.top = closest.getBoundingClientRect().top + 3 -block.offsetHeight + \"px\";\r\n        block.style.left = closest.getBoundingClientRect().left  + \"px\";\r\n    }\r\n    if (from == \"down\") {\r\n        block.classList.add('blocks-item--animate');\r\n        block.style.top = closest.getBoundingClientRect().top - 3 + block.offsetHeight + \"px\";\r\n        block.style.left = closest.getBoundingClientRect().left +\"px\";\r\n        checkPosition().prepend(block)\r\n    }\r\n    if (from == \"left\") {\r\n        block.classList.add('blocks-item--animate');\r\n        block.style.top = closest.getBoundingClientRect().top - 8 + \"px\";\r\n        block.style.left = closest.getBoundingClientRect().left + 8  - block.offsetWidth + \"px\";\r\n        checkPosition().prepend(block)\r\n    }\r\n    if (from == \"right\") {\r\n        block.classList.add('blocks-item--animate');\r\n        block.style.top = closest.getBoundingClientRect().top + 8 + \"px\";\r\n        block.style.left = closest.getBoundingClientRect().left - 8 + block.offsetWidth + \"px\";\r\n    }\r\n\r\n    setTimeout(() => block.classList.remove('blocks-item--animate'), 301);\r\n}"]}